## Elastic Compute Cloud (EC2)

## üß† What EC2 Really Is

EC2 = **Elastic Compute Cloud** ‚Üí basically means:

> ‚ÄúYou can rent virtual computers (servers) on demand.‚Äù

Think of it as your own **computer in the cloud**:

* You choose how powerful it is (CPU, RAM)
* Which OS it runs (Linux, Windows, Mac)
* How much storage it has (EBS, EFS)
* What kind of network and IP it gets
* What security/firewall rules apply

üí° **Elastic** means it can scale up or down anytime ‚Äî manually or automatically.

---

## ‚öôÔ∏è Key EC2 Components

| Feature                         | Meaning                                      | Example                         |
| ------------------------------- | -------------------------------------------- | ------------------------------- |
| **Instance**                    | The actual virtual machine                   | ‚Äút2.micro‚Äù running Ubuntu       |
| **EBS (Elastic Block Store)**   | Persistent storage like a virtual hard drive | `/dev/xvda` mounted on instance |
| **EFS (Elastic File System)**   | Shared file system between many instances    | Web app shared folder           |
| **ELB (Elastic Load Balancer)** | Distributes traffic across instances         | Round-robin load balancing      |
| **ASG (Auto Scaling Group)**    | Automatically increases/decreases instances  | Add 2 more when CPU > 70%       |
| **Security Group**              | Firewall for inbound/outbound rules          | Allow port 22 (SSH), 80 (HTTP)  |
| **User Data**                   | Script run on first boot                     | Install Apache automatically    |

---

## üß∞ EC2 User Data (Bootstrapping)

When you launch an instance, you can include a script (Bash, PowerShell, etc.) that runs **once** when the instance starts.

**Example (Linux):**

```bash
#!/bin/bash
yum update -y
yum install -y httpd
systemctl start httpd
systemctl enable httpd
echo "Hello from EC2" > /var/www/html/index.html
```

‚úÖ Installs Apache
‚úÖ Starts it
‚úÖ Hosts a simple webpage

This automation helps deploy ready-to-use servers in seconds.

---

## üß© EC2 Instance Types ‚Äî Choosing the Right One

| Category                              | Focus                         | Typical Use                         |
| ------------------------------------- | ----------------------------- | ----------------------------------- |
| **General Purpose (e.g. t2, t3, m5)** | Balanced CPU, memory, network | Web apps, small DBs                 |
| **Compute Optimized (e.g. c5, c6g)**  | High CPU power                | Batch processing, ML, game servers  |
| **Memory Optimized (e.g. r5, x2g)**   | Large RAM                     | Databases, analytics, caching       |
| **Storage Optimized (e.g. i3, d2)**   | Fast local disk I/O           | Data warehouses, OLTP, file systems |

**Example instance:**

```
m5.2xlarge
m ‚Üí general purpose
5 ‚Üí 5th generation
2xlarge ‚Üí specific size (8 vCPUs, 32GB RAM)
```

---

## ‚ö° Example Comparison Table

| Instance    | vCPU | Memory  | Storage            | Network       | EBS Bandwidth |
| ----------- | ---- | ------- | ------------------ | ------------- | ------------- |
| t2.micro    | 1    | 1 GiB   | EBS only           | Low           | -             |
| t2.xlarge   | 4    | 16 GiB  | EBS only           | Moderate      | -             |
| c5d.4xlarge | 16   | 32 GiB  | 1 √ó 400GB NVMe SSD | Up to 10 Gbps | 4,750         |
| r5.16xlarge | 64   | 512 GiB | EBS only           | 20 Gbps       | 13,600        |
| m5.8xlarge  | 32   | 128 GiB | EBS only           | 10 Gbps       | 6,800         |

---

## üß≠ EC2 = Foundation of Cloud Architecture

Learning EC2 gives you the base for:

* Load balancing (ELB)
* Auto scaling (ASG)
* Security groups (network protection)
* AMIs (custom machine templates)
* EBS snapshots and backups
* Integration with S3, RDS, CloudWatch, and Lambda

---

## üß± What is a Security Group (SG)?

A **Security Group** is basically a **virtual firewall** attached to your EC2 instance.
It decides what kind of **network traffic is allowed in or out** of your instance.

### üîÅ Simple Mental Model

```
      üåê Internet
           ‚îÇ
           ‚ñº
     [ Security Group ]
           ‚îÇ
           ‚ñº
     [ EC2 Instance ]
```

If a request comes from the internet ‚Üí it must **pass through the SG rules** before reaching EC2.

---

## üß© Core Rules

| Rule Type          | Direction                 | Description                           | Default       |
| ------------------ | ------------------------- | ------------------------------------- | ------------- |
| **Inbound Rules**  | Incoming traffic to EC2   | Who can connect and on which port     | ‚ùå All Blocked |
| **Outbound Rules** | Outgoing traffic from EC2 | What destinations the EC2 can talk to | ‚úÖ All Allowed |

üí° **Only ‚ÄúAllow‚Äù rules** exist ‚Äî there‚Äôs **no concept of ‚ÄúDeny‚Äù** in security groups.

---

## üéØ Security Group Rule Example

| Type  | Protocol | Port Range | Source          |
| ----- | -------- | ---------- | --------------- |
| SSH   | TCP      | 22         | 203.0.113.10/32 |
| HTTP  | TCP      | 80         | 0.0.0.0/0       |
| HTTPS | TCP      | 443        | 0.0.0.0/0       |

**Meaning:**

* Port **22 (SSH)** open only for your IP (safe)
* Port **80, 443** open for everyone (public website access)

---

## üîç Key Concepts to Remember

| Concept                   | Explanation                                                                   |
| ------------------------- | ----------------------------------------------------------------------------- |
| **Attached to Instances** | You can assign 1+ SGs per EC2                                                 |
| **Shared SGs**            | Same SG can be attached to many EC2s                                          |
| **Region/VPC Bound**      | SGs belong to a specific **region** and **VPC**                               |
| **Stateful**              | If inbound allows traffic, the response outbound is **automatically allowed** |
| **Outside the EC2**       | SG filters traffic **before** it reaches the instance                         |
| **Default Behavior**      | Inbound ‚ùå blocked, Outbound ‚úÖ allowed                                         |

---

## ‚ö†Ô∏è Troubleshooting with SGs

| Symptom                   | Likely Cause                             |
| ------------------------- | ---------------------------------------- |
| **Timeout** (no response) | SG or network issue ‚Äî traffic blocked    |
| **Connection Refused**    | App not running on EC2 or wrong port     |
| **Can‚Äôt SSH (port 22)**   | SG inbound rule missing or keypair issue |

---

## ‚öôÔ∏è Classic Port Numbers to Remember

| Port | Protocol | Use                  |
| ---- | -------- | -------------------- |
| 22   | SSH      | Linux login          |
| 21   | FTP      | File transfer        |
| 22   | SFTP     | Secure file transfer |
| 80   | HTTP     | Website (unsecured)  |
| 443  | HTTPS    | Website (secured)    |
| 3389 | RDP      | Windows login        |

---

## üíª SSH (Secure Shell) Access Methods

| Method                   | Platform    | Description                                    |
| ------------------------ | ----------- | ---------------------------------------------- |
| **SSH (CLI)**            | macOS/Linux | `ssh -i key.pem ec2-user@<Public-IP>`          |
| **PuTTY**                | Windows     | GUI-based SSH client (convert `.pem` ‚Üí `.ppk`) |
| **EC2 Instance Connect** | AWS Console | Browser-based SSH (no key required locally)    |

**Tip:** Always keep a separate **Security Group just for SSH (port 22)** ‚Äî helps you control admin access easily.

---

## üß† Quick Visual Summary

```
                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚îÇ      Security Group     ‚îÇ
                 ‚îÇ   (acts like firewall)  ‚îÇ
                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚ñº                                   ‚ñº
      Inbound Rules                       Outbound Rules
   (Traffic coming in)               (Traffic going out)
   Default: Blocked ‚ùå               Default: Allowed ‚úÖ
```

---

## üí∞ EC2 Purchasing Options ‚Äî The Big Picture

AWS gives multiple ways to pay for EC2 so you can balance **cost, flexibility, and reliability**.

| Type                        | Commitment                | Flexibility            | Discount    | Ideal Use Case                        |
| --------------------------- | ------------------------- | ---------------------- | ----------- | ------------------------------------- |
| **On-Demand**               | None                      | High                   | ‚ùå None      | Unpredictable or short workloads      |
| **Reserved Instances (RI)** | 1 or 3 years              | Medium                 | ‚úÖ Up to 72% | Steady workloads (databases, servers) |
| **Savings Plans**           | 1 or 3 years              | High                   | ‚úÖ Up to 72% | Long-term workloads but flexible      |
| **Spot Instances**          | None                      | Low (can stop anytime) | ‚úÖ Up to 90% | Fault-tolerant, batch jobs            |
| **Dedicated Hosts**         | 1 or 3 years or on-demand | None                   | ‚ùå Expensive | Compliance or license-bound workloads |
| **Dedicated Instances**     | None                      | Medium                 | ‚ùå Expensive | Same as above, but less control       |
| **Capacity Reservations**   | Any duration              | Medium                 | ‚ùå None      | Guarantee capacity in a specific AZ   |

---

## üïí 1Ô∏è‚É£ EC2 **On-Demand Instances**

üí° **‚ÄúPay as you go‚Äù**

* **Billing:** per second (Linux/Windows) or per hour (others)
* **No upfront**, **no commitment**
* **Most expensive**, but **most flexible**
* Best for:

  * New or unpredictable apps
  * Development, testing, POCs

üß© **Example:** You run your EC2 web app only during office hours.

---

## üí° 2Ô∏è‚É£ **Reserved Instances (RIs)**

üí∞ Save up to **72% vs On-Demand** by committing for **1 or 3 years**

You ‚Äúreserve‚Äù a specific instance type, region, and OS.

| Term   | Discount | Payment Options            |
| ------ | -------- | -------------------------- |
| 1 Year | Good     | No / Partial / All Upfront |
| 3 Year | Best     | No / Partial / All Upfront |

üß© **Use Case:** Steady workloads like databases or always-on servers.

---

### üåÄ **Convertible Reserved Instances**

* Up to **66% discount**
* You can **change instance type, family, OS, region, or tenancy**
* Great when you expect **future changes** but still want savings.

---

## üí≥ 3Ô∏è‚É£ **Savings Plans**

Think of this as **a more flexible Reserved Instance**.

* Commit to **spending ($/hour)** for 1 or 3 years
  ‚Üí e.g., `$10/hour` of compute
* Get same **up to 72% discount**
* Flexible across:

  * Instance size (m5.xlarge ‚Üí m5.2xlarge)
  * OS (Linux, Windows)
  * Tenancy (Shared, Dedicated)
* Not tied to a specific instance ID

üß© **Use Case:** Long-term workloads that may change types (e.g., autoscaling environments)

---

## ‚ö° 4Ô∏è‚É£ **Spot Instances**

üí∞ **Up to 90% cheaper**
üí• BUT AWS can **terminate anytime** when demand rises.

* You ‚Äúbid‚Äù for unused EC2 capacity.
* If spot price > your bid ‚Üí instance stops.
* AWS gives **2-minute warning** before termination.

üß© **Great for:**

* Batch jobs
* Data analysis
* Image/video processing
* Machine learning training
* CI/CD pipelines

üö´ **Not for:**

* Databases
* Critical or stateful apps

---

## üß± 5Ô∏è‚É£ **Dedicated Hosts**

You get **an entire physical server** exclusively for your use.

| Feature               | Description                                        |
| --------------------- | -------------------------------------------------- |
| Full physical control | No one else shares your host                       |
| BYOL                  | Bring your own licenses (per-core, per-socket)     |
| Compliance            | Meet regulatory or security isolation requirements |
| Cost                  | üí∏ Most expensive                                  |

üß© **Use Case:**
When compliance or software licensing rules require physical isolation.

---

## üß© 6Ô∏è‚É£ **Dedicated Instances**

* Your EC2 runs on hardware **dedicated to your account**
* AWS still manages placement (no control over host)
* Can **share hardware** with other instances in *your account*
* Slightly cheaper than Dedicated Hosts

üß© **Use Case:**
When you need isolation but don‚Äôt care about host-level control.

---

## üß≠ 7Ô∏è‚É£ **Capacity Reservations**

* **Guarantee capacity** in a specific Availability Zone (AZ)
* **No commitment** ‚Äî can create or cancel anytime
* **Pay On-Demand rate**, even if not running
* Combine with RIs or Savings Plans for discounts

üß© **Use Case:**
When you need **guaranteed capacity** (e.g., during peak events or DR failover).

---

## üè® Easy Hotel Analogy (Perfect for remembering)

| Option                   | Analogy                                            | Key Idea                            |
| ------------------------ | -------------------------------------------------- | ----------------------------------- |
| **On-Demand**            | Walk into hotel anytime, pay full price per night  | Flexible but expensive              |
| **Reserved**             | Book long stay at same room ‚Üí discount             | Commitment saves money              |
| **Savings Plans**        | Commit to spend per hour, stay in any room type    | Flexibility + savings               |
| **Spot**                 | Bid for leftover rooms, may get kicked out anytime | Cheap but unreliable                |
| **Dedicated Host**       | Rent an entire building                            | Total control, expensive            |
| **Capacity Reservation** | Book a room even if you don‚Äôt use it               | Pay full price for guaranteed space |

---

## üíµ Example Price Comparison (m4.large ‚Äì us-east-1)

| Type                 | Hourly Cost                                | Notes                   |
| -------------------- | ------------------------------------------ | ----------------------- |
| On-Demand            | $0.10                                      | Base rate               |
| Spot                 | $0.038‚Äì$0.039                              | ~61% off                |
| RI (1yr)             | $0.062 (No Upfront) ‚Äì $0.058 (All Upfront) | 38‚Äì42% off              |
| RI (3yr)             | $0.043 ‚Äì $0.037                            | 57‚Äì63% off              |
| Convertible RI (1yr) | $0.071 ‚Äì $0.066                            | ~34% off                |
| Savings Plan (1yr)   | $0.062 ‚Äì $0.058                            | ~40% off                |
| Dedicated Host       | Highest                                    | Full physical server    |
| Capacity Reservation | $0.10                                      | Full price, no discount |

---

## üß† In Short ‚Äî Choosing Strategy

| Scenario                        | Best Option                       |
| ------------------------------- | --------------------------------- |
| **Testing or temporary app**    | On-Demand                         |
| **Predictable steady load**     | Reserved Instance or Savings Plan |
| **Batch or flexible job**       | Spot Instances                    |
| **Compliance or license needs** | Dedicated Host                    |
| **Need guaranteed capacity**    | Capacity Reservation              |

---
